<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BarLed">
	<resultMap type="qss.vo.BarLedVo" id="BarLedVo" />


	<select id="BarLed_List" parameterType="qss.vo.BarLedVo" resultType="qss.vo.BarLedVo">
	/*
	ID : barled_sql.BarLed_List
	DEC : 마퀴 리스트 조회
	*/
	<include refid="Common.BeforeSQL"/>
		<if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType == 'ADM0001'">
			SELECT A.DOMAIN_IDX
					,A.BRAND_IDX
					,A.MQ_IDX
					,A.MQ_TEXT
					,A.MQ_FONT
					,A.MQ_MOTION
					,A.MQ_SIZE
					,A.MQ_TEXT_COLOR
					,A.MQ_BG_COLOR
					,A.ORDER_SEQ
					,A.ACTIVE_YN
					,A.DEL_YN
					,A.REG_USER
					,date_format(A.REG_DATE, '%Y-%m-%d') AS REG_DATE
					,A.MOD_USER
					,date_format(A.MOD_DATE, '%Y-%m-%d') AS MOD_DATE
					FROM MARQUEE A
      				INNER JOIN brand b ON  b.DOMAIN_IDX = A.DOMAIN_IDX AND b.BRAND_IDX = A.BRAND_IDX AND ifnull(b.DEL_YN, 'N') = 'N'
      				LEFT JOIN (SELECT A.DOMAIN_IDX, A.BRAND_IDX, MQ_IDX , B.FRANC_IDX, A.DEVICE_IDX
      							FROM MARQUEE_TARGET A
      							<if test="francIdx != null and francIdx != 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'  AND B.FRANC_IDX = #{francIdx} 
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if>
      							<if test="francIdx == null or francIdx == 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if>
      							GROUP BY DOMAIN_IDX, BRAND_IDX, MQ_IDX, DEVICE_IDX
			      				) MT ON MT.DOMAIN_IDX = A.DOMAIN_IDX AND MT.BRAND_IDX = A.BRAND_IDX AND A.MQ_IDX = MT.MQ_IDX
			WHERE
			A.DOMAIN_IDX = #{domainIdx}
			AND A.MQ_TYPE = 'LED'
			AND ifnull(A.DEL_YN, 'N') = 'N'
			<if test="brandIdx != null and brandIdx != null and brandIdx != 0">
				AND A.BRAND_IDX = #{brandIdx}
			</if>
			<if test="francIdx != null and francIdx != '' and francIdx != 0">
				AND MT.FRANC_IDX = #{francIdx}
			</if>
			<if test="sSearch != null and sSearch != ''">
				AND A.MQ_TEXT LIKE CONCAT('%',#{sSearch},'%')
			</if>
			GROUP BY A.MQ_IDX
			<if test="sSortName == null or sSortName == ''">
	 			ORDER BY A.ORDER_SEQ, A.MOD_DATE ASC
			</if>
		</if>
		<!-- 시스템 관라지가 아닐경우(서비스, 매장 관리자) -->
		 <if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType != 'ADM0001'">
		 	SELECT A.DOMAIN_IDX
					,A.BRAND_IDX
					,A.MQ_IDX
					,A.MQ_TEXT
					,A.MQ_FONT
					,A.MQ_MOTION
					,A.MQ_SIZE
					,A.MQ_TEXT_COLOR
					,A.MQ_BG_COLOR
					,A.ORDER_SEQ
					,A.ACTIVE_YN
					,A.DEL_YN
					,A.REG_USER
					,date_format(A.REG_DATE, '%Y-%m-%d') AS REG_DATE
					,A.MOD_USER
					,date_format(A.MOD_DATE, '%Y-%m-%d') AS MOD_DATE
					FROM MARQUEE A
					INNER JOIN franchisee f ON  f.DOMAIN_IDX = A.DOMAIN_IDX AND f.BRAND_IDX = A.BRAND_IDX AND ifnull(f.DEL_YN, 'N') = 'N'
      				INNER JOIN brand b ON  b.DOMAIN_IDX = A.DOMAIN_IDX AND b.BRAND_IDX = A.BRAND_IDX AND ifnull(b.DEL_YN, 'N') = 'N'
      				LEFT JOIN (SELECT A.DOMAIN_IDX, A.BRAND_IDX, A.MQ_IDX , B.FRANC_IDX, A.DEVICE_IDX
      							FROM MARQUEE_TARGET A
      							<if test="francIdx != null and francIdx != 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'  AND B.FRANC_IDX = #{francIdx} 
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if>
      							<if test="francIdx == null or francIdx == 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if> 
      							GROUP BY DOMAIN_IDX, BRAND_IDX, MQ_IDX, DEVICE_IDX
			      				) MT ON MT.DOMAIN_IDX = A.DOMAIN_IDX AND MT.BRAND_IDX = A.BRAND_IDX AND A.MQ_IDX = MT.MQ_IDX
			WHERE
			A.DOMAIN_IDX = #{domainIdx}
			AND A.MQ_TYPE = 'LED'
			AND ifnull(A.DEL_YN, 'N') = 'N'
			<if test="sessionBrandIdx != null and sessionAdminType != '' and sessionAdminType == 'ADM0002'">
			 	/* 서비스 관리자는 해당 서비스에 포함된 모든 매장 포함되게 또는 선택한 매장만 */
				AND A.BRAND_IDX = #{sessionBrandIdx}
				<if test="francIdx != null and francIdx != '' and francIdx != 0">
					AND MT.FRANC_IDX = #{francIdx}
				</if>
			 </if>
			 <if test="sessionBrandIdx != null and sessionAdminType != '' and sessionAdminType == 'ADM0003'">
			 	/* 매장 관리자는 자신이 속한 서비스의 자기 매장만 보이게 */
			 	AND A.BRAND_IDX = #{sessionBrandIdx}
				AND MT.FRANC_IDX = #{sessionFrancIdx}
			 </if> 
			<if test="sSearch != null and sSearch != ''">
				AND A.MQ_TEXT LIKE CONCAT('%',#{sSearch},'%')
			</if>
			GROUP BY A.MQ_IDX
			<if test="sSortName == null or sSortName == ''">
				ORDER BY A.ORDER_SEQ, A.MOD_DATE ASC
			</if>
		 </if>
		<include refid="Common.AfterSQL"/>
	</select>
	
	<select id="BarLed_ListCnt" parameterType="qss.vo.BarLedVo" resultType="int">
		/*
		  ID  : barled_sql.BarLed_ListCnt
		  DEC : 마퀴 Cnt 조회
		*/
		<if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType == 'ADM0001'">
			 SELECT COUNT(*) AS CNT 
 			 FROM (
			 SELECT COUNT(A.DOMAIN_IDX)
			 FROM   MARQUEE A
			 		INNER JOIN franchisee f ON  f.DOMAIN_IDX = A.DOMAIN_IDX AND f.BRAND_IDX = A.BRAND_IDX AND ifnull(f.DEL_YN, 'N') = 'N'
      				INNER JOIN brand b ON  b.DOMAIN_IDX = A.DOMAIN_IDX AND b.BRAND_IDX = A.BRAND_IDX AND ifnull(b.DEL_YN, 'N') = 'N'
      				LEFT JOIN (SELECT A.DOMAIN_IDX, A.BRAND_IDX, MQ_IDX , B.FRANC_IDX, A.DEVICE_IDX
      							FROM MARQUEE_TARGET A
      							<if test="francIdx != null and francIdx != 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'  AND B.FRANC_IDX = #{francIdx} 
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if>
      							<if test="francIdx == null or francIdx == 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'
      								<if test="deviceIdx != null and deviceIdx != 0">
      									AND B.DEVICE_IDX = #{deviceIdx}
	      							</if>
      							</if> 
      							GROUP BY DOMAIN_IDX, BRAND_IDX, MQ_IDX, DEVICE_IDX
			      				) MT ON MT.DOMAIN_IDX = A.DOMAIN_IDX AND MT.BRAND_IDX = A.BRAND_IDX AND A.MQ_IDX = MT.MQ_IDX
			 WHERE
			 A.DOMAIN_IDX = #{domainIdx}
			 AND A.MQ_TYPE = 'LED'
			 AND ifnull(A.DEL_YN, 'N') = 'N'
			 <if test="brandIdx != null and brandIdx != null and brandIdx != 0">
				AND A.BRAND_IDX = #{brandIdx}
			 </if>
			 <if test="francIdx != null and francIdx != '' and francIdx != 0">
				AND MT.FRANC_IDX = #{francIdx}
			</if>
			 <if test="sSearch != null and sSearch != ''">
				AND A.MQ_TEXT LIKE CONCAT('%',#{sSearch},'%')
			 </if>
			 GROUP BY A.DOMAIN_IDX, A.BRAND_IDX, A.MQ_IDX ) A
		</if>
		<!-- 시스템 관라지가 아닐경우(서비스, 매장 관리자) -->
		<if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType != 'ADM0001'">
			 SELECT COUNT(*) AS CNT 
 			 FROM (
		 	 SELECT COUNT(A.DOMAIN_IDX) 
			 FROM   MARQUEE A
			 		INNER JOIN franchisee f ON  f.DOMAIN_IDX = A.DOMAIN_IDX AND f.BRAND_IDX = A.BRAND_IDX AND ifnull(f.DEL_YN, 'N') = 'N'
      				INNER JOIN brand b ON  b.DOMAIN_IDX = A.DOMAIN_IDX AND b.BRAND_IDX = A.BRAND_IDX AND ifnull(b.DEL_YN, 'N') = 'N'
      				LEFT JOIN (SELECT A.DOMAIN_IDX, A.BRAND_IDX, MQ_IDX , B.FRANC_IDX, A.DEVICE_IDX
      							FROM MARQUEE_TARGET A
      							<if test="francIdx != null and francIdx != 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'  AND B.FRANC_IDX = #{francIdx} 
      							</if>
      							<if test="francIdx == null or francIdx == 0">
      								INNER JOIN KIOSK B ON A.DEVICE_IDX = B.DEVICE_IDX AND A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND B.DEL_YN = 'N' AND B.ACTIVE_YN = 'Y'
      							</if> 
      							GROUP BY DOMAIN_IDX, BRAND_IDX, MQ_IDX, DEVICE_IDX
			      				) MT ON MT.DOMAIN_IDX = A.DOMAIN_IDX AND MT.BRAND_IDX = A.BRAND_IDX AND A.MQ_IDX = MT.MQ_IDX
			 WHERE
			 A.DOMAIN_IDX = #{domainIdx}
			 AND A.MQ_TYPE = 'LED'
			 AND ifnull(A.DEL_YN, 'N') = 'N'
			 <if test="sessionBrandIdx != null and sessionAdminType != '' and sessionAdminType == 'ADM0002'">
			 	/* 서비스 관리자는 해당 서비스에 포함된 모든 매장 포함되게 또는 선택한 매장만 */
				AND A.BRAND_IDX = #{sessionBrandIdx}
				<if test="francIdx != null and francIdx != '' and francIdx != 0">
					AND MT.FRANC_IDX = #{francIdx}
				</if>
			 </if>

			 <if test="sessionBrandIdx != null and sessionAdminType != '' and sessionAdminType == 'ADM0003'">
			 	/* 매장 관리자는 자신이 속한 서비스의 자기 매장만 보이게 */
			 	AND A.BRAND_IDX = #{sessionBrandIdx}
				AND MT.FRANC_IDX = #{sessionFrancIdx}
			 </if>
			 <if test="sSearch != null and sSearch != ''">
				AND A.MQ_TEXT LIKE CONCAT('%',#{sSearch},'%')
			 </if>
			 GROUP BY A.DOMAIN_IDX, A.BRAND_IDX, A.MQ_IDX ) A
		</if>

	</select>
	
	<insert id="BarLed_Insert" parameterType="qss.vo.BarLedVo" useGeneratedKeys="true">
		/*
		ID : barled_sql.BarLed_Insert
		DEC : 마퀴 텍스트 등록
		*/
		<selectKey keyProperty="mqIdx" resultType="biginteger" order="BEFORE">
			SELECT
				IFNULL(MAX(MQ_IDX) + 1, 1)
			FROM MARQUEE
		</selectKey>
		<![CDATA[
			INSERT INTO MARQUEE
				(
					DOMAIN_IDX,
					BRAND_IDX,
					MQ_IDX,
					MQ_TEXT,
					MQ_FONT,
					MQ_SIZE,
					MQ_MOTION,
			        MQ_TEXT_COLOR,
					MQ_BG_COLOR,
					MQ_TYPE,
					ORDER_SEQ,
					ACTIVE_YN,
					DEL_YN,
					REG_USER,
		            REG_DATE,
		            MOD_USER,
		            MOD_DATE
					)
			VALUES
				(
					#{domainIdx},
       			    #{brandIdx},
       				#{mqIdx},
       				#{mqText},
					#{mqFont},
					#{mqSize},
					#{mqMotion},
			        #{mqTextColor},
					#{mqBgColor},
					'LED',
					#{orderSeq},
		            #{activeYn},
		            'N',
		            #{regUser},
		            NOW(),
		            #{modUser},
		            NOW()
				)
		]]>
	</insert>
	
	<insert id="BarLed_InsertMarqueeTarget" parameterType="java.util.Map">
		/*
		ID : barled_sql.BarLed_InsertMarqueeTarget
		DEC : 마퀴 타겟 정보 등록
		*/
			INSERT INTO MARQUEE_TARGET
				(
					DOMAIN_IDX,
					BRAND_IDX,
					MQ_IDX,
					DEVICE_IDX,
					DISTRIBUTE_YN,
					REG_USER,
		            REG_DATE,
		            MOD_USER,
		            MOD_DATE
					)
			VALUES
				<foreach collection="list" item="item" separator=" , ">
				(
					#{item.domainIdx},
       			    #{item.brandIdx},
       				#{item.mqIdx},
					#{item.deviceIdx},
		            '',
		            #{item.regUser},
		            NOW(),
		            #{item.modUser},
		            NOW()
		        )
		        </foreach>
	</insert>
	
	<delete id="BarLed_DeleteMarqueeTarget" parameterType="qss.vo.BarLedVo">
		/*
		  ID  : barled_sql.BarLed_DeleteMarqueeTarget
		  DEC :  트리 조회
		*/
		DELETE
		FROM	MARQUEE_TARGET
		WHERE	MQ_IDX = #{mqIdx}
	</delete>
	
	<update id="BarLed_Update" parameterType="qss.vo.BarLedVo">
		UPDATE	MARQUEE
		SET		MQ_TEXT = #{mqText},
				MQ_FONT = #{mqFont},
				MQ_SIZE = #{mqSize},
				MQ_MOTION = #{mqMotion},
		        MQ_TEXT_COLOR = #{mqTextColor},
				MQ_BG_COLOR = #{mqBgColor},
				ORDER_SEQ = #{orderSeq},
				ACTIVE_YN = #{activeYn},
	            MOD_USER = #{modUser},
	            MOD_DATE = NOW()
	    WHERE	MQ_IDX = #{mqIdx}
	</update>


	<select id="BarLed_SearchKioskTree" parameterType="hashmap" resultType="hashmap">
		/*
		  ID  : barled_sql.BarLed_SearchKioskTree
		  DEC : 우측 단말기 트리 조회
		*/
		SELECT
		  A.DEPTH
		  ,A.DEPTH_NAME
		  ,A.IDX
		  ,A.NAME
		  ,A.PARENT_IDX
		  ,IF((SELECT IFNULL(MAX(TR.DEVICE_IDX), '0') FROM MARQUEE_TARGET TR WHERE TR.DOMAIN_IDX = A.DOMAIN_IDX AND TR.BRAND_IDX = A.BRAND_IDX AND TR.DEVICE_IDX = A.DEVICE_IDX and TR.MQ_IDX = #{mqIdx})
		      = '0', '0', '1') AS CHECKED
		FROM
		(
		    SELECT  '1' AS DEPTH
				      , 'DOMAIN' AS DEPTH_NAME
				      , DOMAIN_IDX AS IDX
				      , DOMAIN_NAME AS NAME
				      , '0' AS PARENT_IDX
				      , '0' AS CHECKED
		          , DOMAIN_IDX
		          , '0' AS BRAND_IDX
		          , '0' AS GROUP_IDX
		          , '0' AS FRANC_IDX
		          ,'0' AS DEVICE_IDX
				FROM DOMAIN WHERE DOMAIN_IDX = #{domainIdx}
				UNION ALL
				SELECT  '2'
				      , 'BRAND'
				      , CONCAT(DOMAIN_IDX, '_', BRAND_IDX)
				      , NAME
				      , DOMAIN_IDX
				      , '0'
		          , DOMAIN_IDX
		          , BRAND_IDX
		          , '0' AS GROUP_IDX
		          , '0' AS FRANC_IDX
		          ,'0' AS DEVICE_IDX
				FROM    BRAND
				WHERE   ifnull(DEL_YN, 'N') = 'N' AND DOMAIN_IDX = #{domainIdx} AND BRAND_IDX = #{brandIdx}
				UNION ALL
				SELECT  '3'+GROUP_DEPTH
						 , 'GROUP'
						 , CONCAT(DOMAIN_IDX, '_', BRAND_IDX, '_', GROUP_IDX)
						 , GROUP_NAME
						 , CONCAT(DOMAIN_IDX, '_', BRAND_IDX, if( PARENT_GROUP_IDX = '', '', CONCAT('_', PARENT_GROUP_IDX)))
						 , '0'
				          , DOMAIN_IDX
				          , BRAND_IDX
				          , GROUP_IDX
				          , '0' AS FRANC_IDX
				          ,'0' AS DEVICE_IDX
					FROM   SITEGROUP
					WHERE  ifnull(DEL_YN, 'N') = 'N'
				UNION ALL
				SELECT  '4' + B.GROUP_DEPTH
				     , 'FRANCHISEE'
				     , CONCAT(A.DOMAIN_IDX, '_', A.BRAND_IDX, '_', A.GROUP_IDX, '_', A.FRANC_IDX)
					 , FRANC_NAME
					 , CONCAT(A.DOMAIN_IDX, '_', A.BRAND_IDX, '_', A.GROUP_IDX)
		         , '0'
		         , A.DOMAIN_IDX
		         , A.BRAND_IDX
				 , A.GROUP_IDX
		         , A.FRANC_IDX
		         ,'0' AS DEVICE_IDX
				FROM   FRANCHISEE A
					INNER JOIN SITEGROUP B ON A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND A.GROUP_IDX = B.GROUP_IDX
					<if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType == 'ADM0003'">
					/* 매장관리자는 자신것만 보이도록 설정*/
					AND A.FRANC_IDX =  #{sessionFrancIdx}
					</if>
				WHERE  ifnull(A.DEL_YN, 'N') = 'N' AND A.DOMAIN_IDX = #{domainIdx} AND A.BRAND_IDX = #{brandIdx}
				UNION ALL
				SELECT  '5'
				     , 'KIOSK'
				     , CONCAT(A.DOMAIN_IDX, '_', A.BRAND_IDX, '_', B.GROUP_IDX, '_', A.FRANC_IDX, '_', A.DEVICE_IDX)
				     , DEVICE_NAME
				     , CONCAT(A.DOMAIN_IDX, '_', A.BRAND_IDX, '_', B.GROUP_IDX, '_', A.FRANC_IDX)
		         , '0'
		         , A.DOMAIN_IDX
		         , A.BRAND_IDX
				 , B.GROUP_IDX
		         , A.FRANC_IDX
		         , A.DEVICE_IDX
				FROM   KIOSK A
					INNER JOIN FRANCHISEE B ON A.DOMAIN_IDX = B.DOMAIN_IDX AND A.BRAND_IDX = B.BRAND_IDX AND A.FRANC_IDX = B.FRANC_IDX
				WHERE ifnull(A.DEL_YN, 'N') = 'N' AND A.DOMAIN_IDX = #{domainIdx} AND A.BRAND_IDX = #{brandIdx}
				 <if test="searchDvType != null and searchDvType != ''">
				 	AND DEVICE_TYPE = #{searchDvType}
				 </if>
				 <if test="searchDvRes != null and searchDvRes != ''">
				 	AND DEVICE_RES_TYPE = #{searchDvRes}
				 </if>
				 <if test="searchDvSite != null and searchDvSite != ''">
				 	AND DEVICE_SITE_TYPE = #{searchDvSite}
				 </if>
				 <if test="sessionAdminType != null and sessionAdminType != '' and sessionAdminType == 'ADM0003'">
					/* 매장관리자는 자신것만 보이도록 설정*/
					AND A.FRANC_IDX =  #{sessionFrancIdx}
					</if>
		) AS A
	</select>
	
	<select id="BarLed_Get" parameterType="qss.vo.BarLedVo" resultType="qss.vo.BarLedVo">
	/*
	ID : barled_sql.BarLed_Get
	DEC : 마퀴 조회
	*/
	SELECT	DOMAIN_IDX,
			BRAND_IDX,
			MQ_IDX,
			MQ_TEXT,
			MQ_SIZE,
			MQ_FONT,
			MQ_TEXT_COLOR,
			MQ_BG_COLOR,
			ORDER_SEQ,
			ACTIVE_YN,
			DEL_YN,
			MQ_MOTION
	FROM	MARQUEE
	WHERE	MQ_IDX = #{mqIdx}
			AND DEL_YN = 'N'
	</select>
	
	<update id="BarLed_Delete" parameterType="hashmap">
		/*
		ID : barled_sql.BarLed_Delete
		DEC : 마퀴 텍스트 삭제 처리
		*/
				UPDATE  MARQUEE
			    SET     DEL_YN = 'Y',
			    		ACTIVE_YN = 'N',
			            MOD_USER = #{modUser},
			            MOD_DATE = NOW()
			    WHERE   DOMAIN_IDX = #{domainIdx} AND BRAND_IDX = #{brandIdx}
			    AND MQ_IDX IN
				<foreach collection="arrIndex" item="mqIdx"  open="(" close=")" separator=",">
		        #{mqIdx}
		        </foreach>
	</update>
	
	<delete id="BarLed_DeleteMultiMarqueeTarget" parameterType="hashmap">
		/*
		  ID  : barled_sql.BarLed_DeleteMultiMarqueeTarget
		  DEC :  마퀴 타겟 멀티 삭제
		*/
		DELETE
		FROM	MARQUEE_TARGET
		WHERE   DOMAIN_IDX = #{domainIdx} AND BRAND_IDX = #{brandIdx}
			    AND MQ_IDX IN
			    <foreach collection="arrIndex" item="mqIdx"  open="(" close=")" separator=",">
		        #{mqIdx}
		        </foreach>
	</delete>
	
	<update id="BarLed_SetActiveYn" parameterType="qss.vo.BarLedVo">
		UPDATE	MARQUEE
		SET		ACTIVE_YN = #{activeYn},
				MOD_DATE = NOW(),
				MOD_USER = #{modUser}
		WHERE   DOMAIN_IDX = #{domainIdx} 
				AND BRAND_IDX = #{brandIdx}
				AND MQ_IDX = #{mqIdx}
	</update>
	
	<update id="BarLed_SetDistribute" parameterType="qss.vo.BarLedVo">
		UPDATE	MARQUEE_TARGET
		SET		DISTRIBUTE_YN = #{activeYn},
				MOD_DATE = NOW(),
				MOD_USER = #{modUser}
		WHERE   DOMAIN_IDX = #{domainIdx} 
				AND BRAND_IDX = #{brandIdx}
				AND MQ_IDX = #{mqIdx}
	</update>
</mapper>